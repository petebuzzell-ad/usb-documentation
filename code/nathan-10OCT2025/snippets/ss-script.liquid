{%- if customer -%}
    {% capture ss_shopper_config %} shopper.id="{{ customer.id }}"{% endcapture %}
{%- endif -%}

{%- if collection.handle and collection.handle != settings.ss_collection_handle -%}
    {% capture ss_collection_config %} collection="{{ collection.id }}" collection-name="{{ collection.title | replace: '"', '&quot;' }}" collection-handle="{{ collection.handle }}"{% endcapture %}
{%- endif -%}

{%- if current_tags -%}
    {% capture ss_tags_config %} tags="{{ current_tags | join: '|' | replace: '"', '&quot;' }}"{% endcapture %}
{%- endif -%}

{%- if customer and customer.tags -%}
    {% capture ss_customer_tags_config %} customer-tags="{{ customer.tags | join: '|' | replace: '"', '&quot;' }}"{% endcapture %}
{%- endif -%}

{%- if template -%}
    {% capture ss_template_config %} template="{{ template }}"{% endcapture %}
{%- endif -%}

{% capture ss_defer_config %} hide-content="#searchspring-toolbar-top, #searchspring-product-count, #searchspring-search-summary, #searchspring-content"{% endcapture %}
{%- if collection.handle -%}
    {%- if settings.ss_search_only and collection.handle != settings.ss_collection_handle -%}
        {% capture ss_defer_config %} defer{% endcapture %}
    {%- endif -%}
{%- else -%}
    {% capture ss_defer_config %} defer{% endcapture %}
{%- endif -%}

{%- if storefront -%}
  {%- assign region = storefront -%}
    {%- if storefront == "CA" and shop.locale == "fr" -%}
        {%- assign region = 'ca-fr' -%}
    {%- endif -%}
    {% capture ss_site_instance %} region="{{- region | downcase -}}"{% endcapture %}
{%- endif -%}

{%- if settings.coming_soon_text != blank -%}
    {% capture coming_soon_text %} coming-soon-text="{{ settings.coming_soon_text | escape }}"{% endcapture %}
{%- endif -%}

{%- capture ss_domain -%}
  domain = "nathans"
{%- endcapture -%}

{%- if storefront == "US" -%}
    {% capture bonus_discount %} bonusdiscount="true"{% endcapture %}
    {% capture bonus_discount_percentage %} bonusdiscount-percentage="10"{% endcapture %}
    {% comment %} {{ bonus_discount }}{{ bonus_discount_percentage }} {% endcomment %}
{%- endif -%}

{% capture ss_swatches %} swatches_enabled="{{ settings.ss_swatches }}"{%  endcapture %}
{% capture ss_explosion %} show-colorways="{{ collection.metafields["global"]["ss_explosion"] }}"{% endcapture %}

{% comment %}Searchspring Script{% endcomment %}
<script src="//cdn.searchspring.net/search/v3/lts/searchspring.catalog.js?{{ settings.ss_site_id }}"{{ ss_shopper_config }}{{ ss_collection_config }}{{ ss_tags_config }}{{ ss_customer_tags_config }}{{ ss_template_config }}{{ ss_defer_config }}{{ ss_site_instance }}{{ coming_soon_text }}hide-final-sale-collections="{{ settings.seasonal_collections }}"{{ ss_swatches }}{{ ss_explosion }}{{ ss_domain }}></script>
