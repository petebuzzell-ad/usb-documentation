{%- comment -%}
  Params:
    view - routed from outdoorprolink / expertvoice alternate templates
    firstname - used for expertvoice to hardcode inputs
    lastname - used for expertvoice to hardcode inputs
    email - used for expertvoice to hardcode inputs

    discount_level - used for tagging discount level
    purchase_limit - used for tagging purchase limit
{%- endcomment -%}
{% liquid
  assign discount_tag = ""
  assign limit_tag = ""

  assign valid_discount_levels = "20|25|35|40|50|60|70" | split: '|'

  if valid_discount_levels contains discount_level
    assign discount_tag = "discount-" | append: discount_level
  endif
  if purchase_limit != blank
    assign limit_tag = "limit-" | append: purchase_limit
  endif

  assign is_valid_expertvoice = false
  assign is_valid_outdoorprolink = false

  if view == 'expertvoice' and firstname != blank and lastname != blank and email != blank and discount_tag != blank and limit_tag != blank and group_code != blank
    assign is_valid_expertvoice = true
    assign is_pro_page = true
  elsif view == 'outdoorprolink' and discount_tag != blank and limit_tag != blank
    assign is_valid_outdoorprolink = true
    assign is_pro_page = true
  endif
%}

{%- comment -%} Registration Form {%- endcomment -%}
<div class="register-account mx-auto w-full pt-8 pb-10 lg:p-0 lg:max-w-894 lg:py-18">
  <h2 class="text-h3-m lg:text-h3 uppercase text-left mb-2 lg:mb-3">{{ 'customer.register.title' | t }}</h2>
  <div class="lg:mb-4 mb-3 text-left">
    <p class="text-p-s lg:text-p font-normal mb-0">{{ 'customer.register.prompt' | t }} {{ 'customer.register.signin_prompt' | t }}
      <a href="/account/login" class="text-grey-three underline hover:text-blue-one">
        {{ 'customer.login.title' | t }}
      </a>
    </p>
  </div>

  {% form 'create_customer', class: 'account-form flex flex-wrap justify-center lg:-mx-3 lg:justify-between' %}

  <input type="hidden" name="checkout_url" value="/account{% if is_valid_outdoorprolink %}?op_registered=true{% endif %}">
  {%- comment -%} Errors {%- endcomment -%}
  {% if form.errors %}
    <div class="w-full lg:px-3">
      <div class="errors lg:py-1 xs:mb-0 lg:mb-0">
        <ul class="font-normal">
          {% for field in form.errors %}
            <li>
              {% if form.errors.messages[field] contains 'associated' %}
                This email address is already associated with an account. If this account is yours, please try <a href="/account/login#recover" class="underline">resetting your password</a>. Or <a href="/account/login" class="underline">{{ 'customer.login.sign_in' | t }}</a>
              {% else %}
                {{ form.errors.messages[field] }}
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% else %}
    <input type="hidden" name="return_to" value="/account{% if is_valid_outdoorprolink %}?op_registered=true{% endif %}" />
  {% endif %}

  {%- comment -%} Desktop - Left Column {%- endcomment -%}
  <div class="w-full lg:w-4/9 lg:px-3 mt-6 lg:mt-7">

    {%- comment -%} First Name {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="text"
      aria-required="true"

        name="customer[first_name]" id="FirstName" placeholder=" " {% if is_valid_expertvoice %}value="{{ firstname }}" readonly {% elsif form.first_name %}value="{{ form.first_name }}"{% endif %}
        onblur="eHS.customerLogin.validateFieldsOnBlur(event)" data-required
      >
      <label for="FirstName">{{ 'customer.register.first_name' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Last Name {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="text"
      aria-required="true"

        name="customer[last_name]" id="LastName" placeholder=" " {% if is_valid_expertvoice %}value="{{ lastname }}" readonly {% elsif form.last_name %}value="{{ form.last_name }}"{% endif %}
        onblur="eHS.customerLogin.validateFieldsOnBlur(event)" data-required
      >
      <label for="LastName">{{ 'customer.register.last_name' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Email {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="email" name="customer[email]" id="Email"
      aria-required="true"

        placeholder=" " {% if is_valid_expertvoice %}value="{{ email }}" readonly {% elsif form.email %}value="{{ form.email }}"{% endif %} spellcheck="false" autocomplete="off" autocapitalize="off" data-required
        onblur="eHS.customerLogin.validateFieldsOnBlur(event)"
      >
      <label for="Email">{{ 'customer.register.email' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Phone {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="tel" name="customer[note][Phone]" id="Phone"
        placeholder=" "
        aria-required="true"

        onkeyup="eHS.customerLogin.validateFormat(event,'phone')"
        onblur="eHS.customerLogin.validateFieldsOnBlur(event)" data-required
      >
      <label for="Phone">{{ 'customer.register.phone' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Zip code {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="text" name="customer[note][ZipCode]" id="ZipCode"
        placeholder=" " data-zip-field>
      <label for="ZipCode">{{ 'customer.register.zipcode' | t }}</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>
  </div>

  {%- comment -%} Desktop - Right Column {%- endcomment -%}
  <div class="w-full lg:w-4/9 lg:px-3 lg:mt-7">

    {%- comment -%} Birthday {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="text" name="customer[note][Birthday]" id="Birthday" pattern="[0-9]{2}/[0-9]{2}/[0-9]{2,4}"
        placeholder=" " data-date-field
        onblur="eHS.customerLogin.validateFieldsOnBlur(event)">
      <label for="Birthday">Birthday: MM/DD/YYYY</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Gender {%- endcomment -%}
    <div class="relative mb-6 select-wrap w-full">
      <select name="customer[note][Gender]" id="Gender"
        placeholder=" " onchange="eHS.customerLogin.genderSelection()">
        <option value=""></option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
      </select>
      <label for="Gender">Select Gender</label>
      {% comment %} <span class="absolute right-5 top-1/2 transform -translate-y-1/2">
        {% render 'svg-arrow-down', width: '10px', height: '7.5px' %}
      </span> {% endcomment %}
    </div>

    {%- comment -%} Password {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="password" name="customer[password]" id="CreatePassword"
        placeholder=" "
        aria-required="true"

        onblur="eHS.customerLogin.validateFieldsOnBlur(event)" data-required
      >
      <label for="CreatePassword">{{ 'customer.register.password' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>

    {%- comment -%} Confirm Password {%- endcomment -%}
    <div class="relative mb-6 input-wrap w-full">
      <input type="password" name="customer[password_confirmation]" id="PasswordConfirmation"
        placeholder=" "
        aria-required="true"

        onblur="eHS.customerLogin.validateFieldsOnBlur(event)" data-required
      >
      <label for="PasswordConfirmation">{{ 'customer.reset_password.password_confirm' | t }}*</label>
      <div class="text-error-one flex items-center mt-2 hidden" data-error-container role="alert">
        <span class="mr-2.5">
          {% render 'svg-alert' %}
        </span>
        <span class="font-normal text-p-xs text-grey-one" data-error-text></span>
      </div>
    </div>
  </div>


  {%- comment -%} Interests {%- endcomment -%}
  {%- assign interests = "Commuting,Mountain,Studio/Fitness,Cyclocross,Road,Triathlons" -%}
  {%- assign interests_array = interests | split: "," -%}
  <div class="w-full mb-5 lg:w-47% lg:px-3 lg:mb-14 input-wrap w-full">
    {%- comment -%} Hidden Interests Input {%- endcomment -%}
    <input data-interests-input type="hidden" name="customer[note][Interests]" value="" />

    <p class="font-lato font-semibold text-special text-left uppercase mt-3 mb-2">I'm interested in:</p>
    <div class="flex flex-wrap -mx-1.5">
      {%- for interest in interests_array -%}
        <div class="w-1/2 sm:w-1/3 px-1.5">
          <label  tabindex="0" class="custom-checkbox text-p font-normal leading-8">{{ interest }}
            <input type="checkbox" name="{{ interest }}" data-interest data-value="{{ interest | handleize }}">
            <span class="checkmark"></span>
          </label>
        </div>
      {%- endfor -%}
    </div>
  </div>

  {%- comment -%} Shopping For {%- endcomment -%}
  {%- assign shopping_for = "Men,Women,Kids" -%}
  {%- assign shopping_for_array = shopping_for | split: "," -%}
  <div class="w-full mb-10 lg:w-4/9 lg:px-3 lg:mb-14">
    {%- comment -%} Hidden Shopping For Input {%- endcomment -%}
    <input data-shopping-for-input type="hidden" name="customer[note][Shopping For]" value="" />
    <p class="font-lato font-semibold text-special text-left uppercase mt-3 mb-2">Shopping for:</p>
    <div class="flex flex-wrap -mx-1.5">
      {%- for sf_item in shopping_for_array -%}
        <div class="w-full sm:w-1/3 px-1.5">
          <label   tabindex="0" class="custom-checkbox text-p font-normal leading-8">{{ sf_item }}
            <input type="checkbox" name="{{ sf_item }}" data-shopping-for data-value="{{ sf_item | handleize }}">
            <span class="checkmark"></span>
          </label>
        </div>
      {%- endfor -%}
    </div>
  </div>

  {%- comment -%} Accepts Marketing {%- endcomment -%}
  <div class="w-full mb-4 lg:px-3 lg:mb-10">
    <div class="border-t border-grey-five py-7">
      <p class="font-lato font-semibold text-special text-left uppercase mb-3">Want to receive exclusive Nathan Sports email updates?</p>
      <div id="accepts_marketing">
        <label for="marketing" class="custom-checkbox text-p font-normal py-0.75 px-6">
          <input type="hidden" name="customer[accepts_marketing]" value="" />
          <input type="checkbox" name="customer[accepts_marketing]" class="absolute cursor-pointer hidden"
            id="marketing" checked/>
          <span class="checkmark"></span>
          Sign up to receive emails with Nathan Sports news, specials offers and promotions. You can unsubscribe at any time. See our <a href="#" class="text-grey-three hover:text-blue-one underline">privacy policy</a> for more information.
        </label>
      </div>
    </div>
  </div>

  {%- comment -%} Hidden Fields to Apply Pro Member Tags {%- endcomment -%}
  {%- if is_valid_expertvoice -%}
    {%- comment -%} Expert Voice registration {%- endcomment -%}
    <input type="hidden" name="customer[tags]" value="Expert Voice, {{ discount_tag }}, {{ limit_tag }}" />
  {%- elsif is_valid_outdoorprolink -%}
    {%- comment -%} Outdoor Prolink registration {%- endcomment -%}
    <input type="hidden" name="customer[tags]" value="Outdoor Pro, {{ discount_tag }}, {{ limit_tag }}" />
  {%- endif -%}

  {%- comment -%} Submit Registration Form + Cancel {%- endcomment -%}
  <div class="w-full lg:px-3 text-center">
    <button type="button" class="form-submit button button-primary mb-10 w-full max-w-full py-4.5 cursor-pointer">{{ 'customer.register.submit' | t }}</button>
    
    <a href="/account/login"
      class="inline-block text-special mb-8 font-lato font-semibold uppercase text-grey-one hover:text-blue-one border-b-2 border-grey-one hover:border-blue-one">
      {{ 'customer.register.cancel' | t }}
    </a>
  </div>

  {% endform %}

</div>

