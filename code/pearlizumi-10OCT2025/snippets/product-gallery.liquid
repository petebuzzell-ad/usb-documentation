

{% liquid
  assign gallery_video = product.metafields["global"]["product_videos_en"]
  assign video_id = false
  if gallery_video != blank
    assign video_id = gallery_video | split: '/' | last | remove: "watch?v=" | strip
  endif
%}
<!-- Product Gallery -->
<div class="pdp-gallery flex pt-0 mobile:w-full opacity-0 transition-all duration-200" data-pg {% if gift_card %}data-gift-pg{% endif %} {% if video_id%}data-video-id="{{ video_id | escape }}"{% endif %}>
  <!-- Product Gallery Thumbnails -->
  <div id="galleryThumbs" class="relative mr-2.5 md:mr-9" data-pg-thumb-slides>
    {% if video_id %}
      <div class="thumbnail thumbnail--video relative border-2 border-transparent h-full hover:border-silver cursor-pointer group" data-origin-index="video">
        <img src="https://img.youtube.com/vi/{{ video_id }}/0.jpg" alt="Youtube Video - {{video_id}}" class="absolute w-full h-full object-cover -z-1" loading="lazy" />
        <span class="play-video-btn block w-full pt-[100%] cursor-pointer z-1">
          <span class="absolute bg-bright-yellow group-hover:bg-[faded-bright-yellow] block rounded-full inset-1/4 z-1 opacity-80"></span>
          {%- render 'svg-play-light', classes: 'absolute z-2 top-1/2 left-1/2 cursor-pointer transform -translate-y-1/2 -translate-x-1/3 w-2 h-3' -%}
        </span>
      </div>
    {% endif %}
  </div>

  <div class="relative w-full flex-1 px-6 md:px-0">
    <div class="product-gallery relative">
      {%- unless storefront == "INT" -%}
        <!-- Badge -->
        <span class="absolute top-4 left-4 z-2" data-badge-container>
          {%- render 'product-badge' product: product -%}
        </span>
      {%- endunless -%}

      <!-- Main Gallery -->
      <div class="bg-transparent md:bg-faint-cloud pb-10 md:pb-0" data-pg-main-slides onscroll="window.eHS.productGallery.imageScrollbar()">
        {% if video_id %}
          <div class="product-video" data-origin-index="video">
            <div class="w-full relative lg:pt-[100%]">
              <div class="block pt-[100%] lg:hidden group">
                <img src="https://img.youtube.com/vi/{{ video_id }}/0.jpg" alt="product video - {{video_id}}" class="absolute w-full h-full top-0 left-0 object-cover -z-1" loading="eager"/>
                <span class="absolute bg-lush block group-hover:bg-light-lush rounded-full w-12 h-12 z-1 opacity-80 top-1/2 left-1/2 cursor-pointer transform -translate-x-1/2 -translate-y-1/2"
                  data-video-modal-id="gallery_video_modal" data-gallery-video-btn>
                  {%- render 'svg-play-light', classes: 'absolute z-2 top-1/2 left-1/2 cursor-pointer transform -translate-y-1/2 -translate-x-1/3 w-4 h-6' -%}
                </span>
              </div>
              <iframe id="gallery_video" class="absolute inset-0 hidden opacity-0 invisible lg:opacity-100 lg:visible lg:block" src="https://www.youtube.com/embed/{{ video_id }}?playlist={{ video_id }}&loop=1&rel=0&iv_load_policy=3&modestbranding=1&controls=0&showinfo=0&mute=1" width="100%" height="100%" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
          </div>
        {% endif %}


    <div class="scroll-bar">
      <div class="scroll-thumb"></div>
    </div>
      </div>
      {%- comment -%} Don't render mobile markup on quickview {%- endcomment -%}
      {%- unless quickview -%}
        <!-- Mobile Gallery Video Modal -->
        <div id="gallery_video_modal" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 shadow-modal max-w-1010 w-full z-50">
          <span class="absolute left-auto right-1 -top-14 xl:top-auto xl:bottom-full xl:right-auto xl:left-full shadow-modal rounded-full bg-white w-10 h-10 flex items-center justify-center cursor-pointer" data-gallery-video-modal-close>
            {%- render 'svg-close' -%}
          </span>
          <div class="relative h-0 w-full pt-16:9">
            <iframe class="absolute inset-0" src="https://www.youtube.com/embed/{{ video_id }}?playlist={{ video_id }}&loop=1&rel=0&iv_load_policy=3&modestbranding=1&controls=0&showinfo=0&mute=1" width="100%" height="100%" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
          </div>
        </div>
      {%- endunless -%}
    </div>
    {%- if quickview -%}
      <div class="text-center mt-6">
        <a data-quickview-view-product-details href="{{product.selected_or_first_available_variant.url}}" class="inline-flex items-center mx-auto text-special font-medium border border-b-2 border-l-0 border-r-0 border-t-0 font-sora uppercase hover:text-pine">
          {%- render 'svg-eye' -%}
          <span class="ml-2">{{ 'products.product.view_details' | t }}</span>
        </a>
      </div>
    {%- else -%}
      <div class="absolute bottom-4 left-6 right-6 md:w-auto md:static text-center md:mt-1 font-normal text-p-ms text-black" data-pg-model-info></div>
    {%- endif -%}


  </div>

  {% if product.metafields["global"]["featured_quote"] %}
    <div class="hidden lg:block mt-20 text-center">
      <div class="flex w-full justify-center items-center mb-5">
        {% for number in (1..5) %}
          {% render 'svg-review-star' %}
        {% endfor %}
      </div>
      <div>
        <p>{{ product.metafields["global"]["featured_quote"] }}</p>
        <span class="p-s font-sora text-stone"><i>- {{ product.metafields["global"]["featured_quote_author"] }}&nbsp;&nbsp;Verified Buyer</i></span>
      </div>
    </div>
  {% endif %}
</div>
