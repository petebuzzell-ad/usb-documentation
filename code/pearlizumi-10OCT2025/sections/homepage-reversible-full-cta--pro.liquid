{% liquid
  assign pro_homepage_enabled = settings.enable_pro_homepage
  assign ev_homepage_enabled = settings.enable_ev_homepage
  assign op_homepage_enabled = settings.enable_op_homepage

  assign is_pro_customer = false
  assign is_ev_customer = false
  assign is_op_customer = false
  if customer.tags contains 'Pro Purchase' or customer.tags contains 'PRO PURCHASE'
    assign is_pro_customer = true
  elsif customer.tags contains 'Expert Voice'
    assign is_ev_customer = true
  elsif customer.tags contains 'Outdoor Pro'
    assign is_op_customer = true
  endif

  assign use_pro_homepage = false
  assign use_ev_homepage = false
  assign use_op_homepage = false

  if pro_homepage_enabled and is_pro_customer
    assign use_pro_homepage = true
  elsif ev_homepage_enabled and is_ev_customer
    assign use_ev_homepage = true
  elsif op_homepage_enabled and is_op_customer
    assign use_op_homepage = true
  endif
%}

{%- if use_pro_homepage -%}
  {%- if section.blocks.size > 0 -%}
    <div class="container max-w-full mb-20 md:mb-40 px-6 md:px-10 lg:px-15 xl:px-25 overflow-hidden">
      {%- assign first_block_found = false -%}
      {%- for block in section.blocks -%}
        {%- if block.settings.image != blank and block.settings.title != blank and block.settings.cta_title != blank and block.settings.url != blank -%}
          <div class="flex {% if block.settings.alignment == 'right' %} flex-col-reverse {% else %} flex-col {% endif %} md:grid md:grid-flow-col md:grid-cols-2 md:gap-5 pt-10 md:pt-20 {% if first_block_found %} mt-10 md:mt-20 {% endif %}">
            {%- if block.settings.alignment == 'right' -%}
              <div class="relative">
                <div class="md:absolute md:max-w-387 left-auto md:left-1/2 lg:left-20 md:top-1/2 md:transform md:-translate-y-1/2 md:-translate-x-1/2 lg:-translate-x-0">
                  {%- if block.settings.subtitle != blank -%}
                    <div class="pl-2.5 text-special font-sora uppercase font-semibold border border-sand border-l-2 border-t-0 border-b-0 border-r-0 mb-2 lg:mb-4">{{- block.settings.subtitle -}}</div>
                  {%- endif -%}
                  <h3 class="text-h5 lg:text-h3 uppercase mb-4 lg:mb-8">{{- block.settings.title -}}</h3>
                  {%- if block.settings.description != blank -%}
                    <div class="hidden lg:block mb-4 lg:mb-10">{{- block.settings.description -}}</div>
                  {%- endif -%}
                  <a href="{{block.settings.url}}" class="button button-outline-dark hidden lg:block">{{- block.settings.cta_title -}}</a>
                  <a href="{{block.settings.url}}" class="inline-block lg:hidden font-semibold text-special-xs px-0 h-5 border border-t-0 border-l-0 border-r-0 border-b-2 uppercase font-sora">{{- block.settings.cta_title -}}</a>
                </div>
              </div>
            {%- endif -%}
            <div class="w-full h-0 pt-[100%] relative mb-6 md:mb-0">
              <img class="lazy z-1 absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full h-full object-cover" src="{{ block.settings.image | img_url: '600x', scale: 2 }}" alt="{{- block.settings.image.alt -}}">
              <img class="lazy z-0 w-11/12 absolute -top-1/8 md:-top-1/10 {% if block.settings.alignment == 'right' %} transform rotate-180 -right-6 md:-right-25 {% else %} -left-6 md:-left-25 {% endif %} hidden md:block" src="https://cdn.shopify.com/s/files/1/0518/9405/9179/files/branch_desktop.svg?v=1625243257">
              {%- if block.settings.alignment == 'left' -%}
                <img class="lazy z-0 w-11/12 absolute -top-1/8 md:-top-1/10 -left-6 md:-left-25 block md:hidden" src="https://cdn.shopify.com/s/files/1/0518/9405/9179/files/svg_branch_left.svg?v=1625178686">
              {%- endif -%}
              {%- if block.settings.alignment == 'right' -%}
                <img class="lazy z-0 w-11/12 absolute -top-1/8 md:-top-1/10 -right-6 md:-right-25 block md:hidden" src="https://cdn.shopify.com/s/files/1/0518/9405/9179/files/svg_branch_right.svg?v=1625178686">
              {%- endif -%}
            </div>
            {%- if block.settings.alignment == 'left' -%}
              <div class="relative">
                <div class="md:absolute md:max-w-387 left-auto md:left-1/2 lg:left-20 md:top-1/2 md:transform md:-translate-y-1/2 md:-translate-x-1/2 lg:-translate-x-0">
                  {%- if block.settings.subtitle != blank -%}
                    <div class="pl-2.5 text-special font-sora uppercase font-semibold border border-sand border-l-2 border-t-0 border-b-0 border-r-0 mb-2 lg:mb-4">{{- block.settings.subtitle -}}</div>
                  {%- endif -%}
                  <h3 class="text-h5 lg:text-h3 uppercase mb-4 lg:mb-8">{{- block.settings.title -}}</h3>
                  {%- if block.settings.description != blank -%}
                    <div class="hidden lg:block mb-4 lg:mb-10">{{- block.settings.description -}}</div>
                  {%- endif -%}
                  <a href="{{block.settings.url}}" class="button button-outline-dark hidden lg:block">{{- block.settings.cta_title -}}</a>
                  <a href="{{block.settings.url}}" class="inline-block lg:hidden font-semibold text-special-xs px-0 h-5 border border-t-0 border-l-0 border-r-0 border-b-2 uppercase font-sora">{{- block.settings.cta_title -}}</a>
                </div>
              </div>
            {%- endif -%}
            {%- if first_block_found == false -%}
              {%- assign first_block_found = true -%}
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  {%- endif -%}
{%- endif -%}

{% schema %}
{
  "name": "Reversible Full CTA (Pro)",
  "settings": [
    {
      "type": "header",
      "content": "Reversible Full CTA (Pro)"
    }
  ],
  "blocks": [
    {
      "name": "Item",
      "type": "item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Desktop image",
          "info": "Recommended size: 1200x1200"
        },
        {
          "type": "select",
          "id": "alignment",
          "options": [
            { "value": "left", "label": "Left"},
            { "value": "right", "label": "Right"}
          ],
          "label": "Image postion",
          "default": "left"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle",
          "default": "Shop by Sport"
        },
        {
          "type": "text",
          "id": "title",
          "label": "title",
          "default": "Road"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description",
          "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."
        },
        {
          "type": "text",
          "id": "cta_title",
          "label": "CTA title",
          "default": "Outline"
        },
        {
          "id": "url",
          "type": "url",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Reversible Full CTA (Pro)",
      "category": "Homepage"
    }
  ]
}

{% endschema %}