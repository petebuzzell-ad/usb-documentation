{% liquid
  assign discount_value = false
  assign limit_value = false
  assign redirect_home = false
  assign page_content = page.content

  if page.handle == "pro"
    if customer
      for tag in customer.tags
        if tag contains "discount-"
          assign discount_value = tag | remove: 'discount-'
        endif
        if tag contains "limit-"
          assign limit_value = tag | remove: 'limit-' | prepend: "$"
        endif
        if discount_value and limit_value
          break
        endif
      endfor

      if shop.permanent_domain == 'pearlizumi.myshopify.com'
        assign storefront = "US"
      elsif shop.permanent_domain == 'pearlizumi-ca.myshopify.com'
        assign storefront = "CA"
      elsif shop.permanent_domain == 'pearl-izumi-int.myshopify.com'
        assign storefront = "INT"
      endif

      if storefront == "CA"
        assign limit_value = limit_value | append: ' CAD'
      endif

    endif

    if discount_value and limit_value
      assign page_content = page.content | replace: "{limit}", limit_value | replace: "{discount}", discount_value
    else
      assign redirect_home = true
    endif
  endif
%}
{%- if redirect_home -%}
  <script>window.location.replace("https://{{ shop.permanent_domain }}")</script>
{%- else -%}
  {% assign subNav = page.metafields["global"]["side_navigation_handle"] %}
  {% render 'page-side-nav', subNav: subNav, show: 'block lg:hidden mobile__nav relative' %}
  
  <div class="general-content-main bg-white" id="pageTemplate">
    {% assign desktop_banner = page.metafields["global"]["desktop_header_banner"] %}
    {% assign mobile_banner = page.metafields["global"]["mobile_header_banner"] %}
    {% assign text_color = page.metafields.global.header_text_shade %}
    {% render 'page-header' desktop_banner: desktop_banner mobile_banner: mobile_banner text_color: text_color %}
  
    <div class="container max-w-full 1.5xl:max-w-1200 mx-auto pt-16 pb-30 px-6 md:px-14 lg:pt-30 lg:pb-36 lg:px-22.5 1.5xl:px-0
      block lg:grid lg:gap-5{% if subNav %} lg:grid-cols-4 {% else %} lg:grid-cols-8 {% endif %}">
      {% render 'page-side-nav', subNav: subNav, show: 'hidden lg:block desktop__nav' %}
      <div
        class="{% if subNav == blank %}mx-auto col-start-2 col-span-6 {% else %} col-span-3 {% endif %} general-content-template">
        {% if desktop_banner == blank %}
        <h1 class="{% if mobile_banner %}hidden lg:block{% endif %} w-full mx-auto lg:max-w-920">{{ page.title }}</h1>
        {% endif %}
        {% include 'shortcode' load: page_content %}
      </div>
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "UI Kit",
  "settings": [],
  "presets": [
    {
      "name": "UI Ki",
      "category": "Page"
    }
  ]
}
{% endschema %}
